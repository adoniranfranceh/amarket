<div class="float-end"><%= link_to 'Adicionar novo', new_admin_template_category_path, class: 'btn btn-success mb-2' %></div>
<%= form_tag(admin_template_categories_path, method: :get, class: "form-inline mb-3") do %>
  <div class="form-group mr-2">
    <%= label_tag :search, "Pesquisar por:" %>
    <%= text_field_tag :search, params[:search], class: "form-control", placeholder: "Nome ou descrição" %>
  </div>
  <%= submit_tag "Pesquisar", class: "btn btn-primary mr-2" %>
  <%= link_to "Limpar", admin_template_categories_path, class: "btn btn-secondary" %>
<% end %>
<div>
  <table class="table table-bordered dataTable dtr-inline">
    <thead>
      <tr>
        <th class="col-1">Id</th>
        <th class="col-5">Nome</th>
        <th class="col-4">Descrição</th>
        <th class="col-2">Ações</th>
      </tr>
    </thead>

    <tbody>
      <% @categories.each do |category| %>   
      <tr>
        <td><%= category.id %></td>
        <td><%= category.name %></td>
        <td>
          <% description = category.descryption.present? ? category.descryption : "Sem descrição" %>
          <% max_characters = 40 %>
            <% truncated_description = description.length > max_characters ? "#{description[0...max_characters]}..." : description %>
          <span class="text-truncate tooltipped" data-toggle="tooltip" title="<%= description %>">
            <%= truncated_description %>
          </span>
        </td>
        <td>
          <%= link_to admin_template_category_path(category), class: "btn btn-info btn-sm", title: 'Ver' do %>
            <i class="bi bi-eye-fill"></i>
          <% end %>
          <button class="btn btn-warning btn-sm" data-toggle="modal" data-target="#category<%= category.id %>" title="Produtos cadastrados em <%= category.name %>">
            <i class="bi bi-bookmark-fill"></i>
          </button>
          <%= render partial: 'admin_template/shared/modals/categories_modal', locals: {category: category} %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
</div>
