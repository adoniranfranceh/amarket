<%= javascript_pack_tag 'sales', 'data-turbolinks-track': 'reload' %>
<%= javascript_pack_tag 'other', 'data-turbolinks-track': 'reload' %>
<%= simple_form_for [:admin_template, @sale], remote: false, authenticity_token: true do |form| %>
  <div class="<%= fieldset_disabled %>">
    <div class="mb-3">
      <%= form.input :customer_id, as: :select, collection: @customers, label: 'Selecione o cliente', include_blank: true, input_html: { class: 'form-control select2 required-field', id: 'sale_customer_id' } %>
      <div class="error-message"></div>
    </div>
    <div class="mb-3">
      <div class="mb-3">
        <%= render 'modal_sale' %>
      </div>
      <div class="mb-3">
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
          Adicionar Produto
        </button>
        <div class="error-message"></div>
        <%= form.hidden_field :secondaryproduct_ids, id: 'product-id-list', class: 'required-field' %>
        <%= render partial: 'products_select' %>
      </div>
    </div>
    <div class="mb-3 row div-center">
      <div class="form-group">
        <div class="form-description">Preço Total:</div>
        <%= icon_number_field(form, :total_price, 'currency-dollar', step: 0.01, id: 'total-price-input', disabled: true) %>
      </div>
      <div class="form-group">
        <div class="form-description">Quantidade:</div>
        <%= icon_number_field(form, :quantity, 'bag-fill', step: 0.01, id: 'total-quantity-input', disabled: true) %>
      </div>
    </div>
    <div class="mb-3 row div-center">
      <div class="form-group">
        <div class="form-description">Taxas:</div>
        <%= icon_number_field(form, :taxes, 'percent', step: 0.01, id: 'taxes-input') %>
      </div>
      <div class="form-group">
        <div class="form-description">Desconto:</div>
        <%= icon_number_field(form, :discount, 'percent', step: 0.01, id: 'discount-input') %>
      </div>
      <div class="form-group">
        <div class="form-description">Valor do Cliente:</div>
        <%= icon_number_field(form, :customer_value, 'currency-dollar', step: 0.01, id: 'customer_value') %>
      </div>
      <div class="form-group">
        <div class="form-description">Troco:</div>
        <%= icon_number_field(form, :change, 'cash-stack', step: 0.01, id: 'change-input', disabled: true) %>
      </div>
    </div>
    <div class="mb-3">
      <%= form.collection_select :payment_method, available_payment_methods, :itself, :itself, { include_blank: 'Selecione um método de pagamento' }, { class: 'form-control', id: 'paymentMethod' } %>
    </div>
    <div id="others_for_sales">
      <%= form.simple_fields_for :others_for_sales do |others_for_sale| %>
        <%= render partial: 'others_for_sale_fields', locals: { f: others_for_sale } %>
      <% end %>
      <div class="links">
        <%= link_to_add_association 'Adicionar Outro', form, :others_for_sales, class: 'btn btn-primary', id: 'btnSubmit' %>
      </div>
    </div>
    <div class="mb-3">
      <%= form.collection_select :status, Sale::STATUS_OPTIONS.values, :to_s, ->(status) { status.to_s.humanize }, { include_blank: 'Selecione um status' }, class: 'form-control' %>
    </div>
    <div class="mb-3">
      <%= form.text_area :comments, class: 'form-control', rows: 3 %>
    </div>
    <%= form.submit 'Salvar', class: 'btn btn-primary' %>
    <%= params[:customer_value] %>
  </div>
<% end %>
